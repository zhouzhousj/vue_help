import"./el-popper-ce6f60b6.js";import{E as d,b as p,c as E,d as C,e as T,f as k,g as w,h as P,i as v}from"./cms_help-67787740.js";import{E as f,a as z,b as S}from"./el-form-item-9707b8fb.js";import{_ as B,o as U,e as A,I as h,M as l,w as o,O as K,J as _,K as M}from"./index-605b105c.js";import"./aria-bc8e8b0f.js";const N={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null,isEdit:!1}},computed:{paginatedData(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.filteredtableData.slice(t,e)},filteredtableData(){return this.searchText&&this.tableData&&this.tableData.length>0?this.tableData.filter(t=>String(t.categoryId)===String(this.searchText)):this.tableData||[]}},methods:{formatDate(t,e,c,g){return new Date(c).toLocaleString()},openEditDialog(t){this.isEdit=!0,this.editItem={...t},this.editDialogVisible=!0},handlePageChange(t){this.currentPage=t},saveEdit(){console.log(this.editItem),f.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.tableData.findIndex(e=>e.id===this.editItem.id);t!==-1?this.tableData.splice(t,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,this.Alter(this.editItem),d.success("修改成功！"),this.editItem={}}).catch(()=>{d.info("修改取消！")})},fetchData(){p.Page(this.json).then(t=>{this.tableData=t.data.data.page.records||t.data.records,console.log(this.tableData)}).catch(t=>{console.error("Error fetching data:",t)})},Insert(t){p.Add(t).then(e=>{d.success("插入数据成功！"),console.log(e)}).catch(e=>{d.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(t){p.Edit(t).then(e=>{console.log("修改保存成功:",e.data)}).catch(e=>{console.error("保存修改失败:",e)}),this.fetchData()},Del(t){f.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{p.Del(t.id).then(e=>{const c=this.tableData.findIndex(g=>g.id===t.id);c!==-1&&this.tableData.splice(c,1),d.success("删除成功！")}).catch(e=>{d.error(response.msg)})}).catch(()=>{})},add(){this.isEdit=!1,this.editDialogVisible=!0,this.editItem={}},addAPI(){this.Insert(this.editItem);const t=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(t),this.editDialogVisible=!1,this.fetchData()},choose(){this.isEdit?this.saveEdit():this.addAPI()}},created(){this.fetchData()}},j={class:"root"},F={style:{display:"flex"}},J=h("span",null,"添加",-1),L=h("span",null,"编辑",-1),O=h("span",null,"删除",-1),R={slot:"footer"};function q(t,e,c,g,a,n){const u=E,r=C,s=P,b=v,D=T,I=k,m=z,V=S,x=w;return U(),A("div",j,[h("div",F,[l(u,{type:"primary",size:"normal",onClick:n.add},{default:o(()=>[J]),_:1},8,["onClick"]),l(r,{modelValue:a.searchText,"onUpdate:modelValue":e[0]||(e[0]=i=>a.searchText=i),placeholder:"请输入搜索categoryId",clearable:"",onClear:t.clearSearch,onKeyup:K(t.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"])]),l(D,{data:n.paginatedData,"header-cell-style":{background:"#feeeed",color:"#606266"},borde:""},{default:o(()=>[l(s,{width:"70rpx",prop:"id",label:"id"}),l(s,{width:"120rpx",prop:"categoryId",label:"categoryId"}),l(s,{prop:"title",label:"标题"}),l(s,{width:"240rpx",prop:"content",label:"内容"}),l(s,{width:"240rpx",prop:"icon",label:"图标"},{default:o(({row:i})=>[l(b,{src:i.icon},null,8,["src"])]),_:1}),l(s,{prop:"readCount",label:"阅读数量"}),l(s,{width:"200rpx",prop:"createTime",formatter:n.formatDate,label:"创建时间"},null,8,["formatter"]),l(s,{width:"200rpx",label:"操作"},{default:o(({row:i})=>[l(u,{type:"info",size:"mini",onClick:y=>n.openEditDialog(i)},{default:o(()=>[L]),_:2},1032,["onClick"]),l(u,{type:"danger",size:"mini",onClick:y=>n.Del(i)},{default:o(()=>[O]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(I,{"current-page":a.currentPage,"page-size":a.pageSize,total:n.filteredtableData.length,onCurrentChange:n.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),l(x,{class:"form",modelValue:a.editDialogVisible,"onUpdate:modelValue":e[7]||(e[7]=i=>a.editDialogVisible=i),onClose:e[8]||(e[8]=i=>a.editDialogVisible=!1)},{default:o(()=>[l(V,null,{default:o(()=>[l(m,{label:"categoryId"},{default:o(()=>[l(r,{modelValue:a.editItem.categoryId,"onUpdate:modelValue":e[1]||(e[1]=i=>a.editItem.categoryId=i)},null,8,["modelValue"])]),_:1}),l(m,{label:"标题"},{default:o(()=>[l(r,{modelValue:a.editItem.title,"onUpdate:modelValue":e[2]||(e[2]=i=>a.editItem.title=i)},null,8,["modelValue"])]),_:1}),l(m,{label:"内容"},{default:o(()=>[l(r,{modelValue:a.editItem.content,"onUpdate:modelValue":e[3]||(e[3]=i=>a.editItem.content=i)},null,8,["modelValue"])]),_:1}),l(m,{label:"图标"},{default:o(()=>[l(r,{modelValue:a.editItem.icon,"onUpdate:modelValue":e[4]||(e[4]=i=>a.editItem.icon=i)},null,8,["modelValue"])]),_:1}),l(m,{label:"阅读数量"},{default:o(()=>[l(r,{modelValue:a.editItem.readCount,"onUpdate:modelValue":e[5]||(e[5]=i=>a.editItem.readCount=i)},null,8,["modelValue"])]),_:1})]),_:1}),h("div",R,[l(u,{onClick:e[6]||(e[6]=i=>a.editDialogVisible=!1)},{default:o(()=>[_("取消")]),_:1}),l(u,{type:"primary",onClick:n.choose},{default:o(()=>[_(M(a.isEdit?"更新":"添加"),1)]),_:1},8,["onClick"])])]),_:1},8,["modelValue"])])}const Y=B(N,[["render",q]]);export{Y as default};
