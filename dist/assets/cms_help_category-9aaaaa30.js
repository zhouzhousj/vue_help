import"./el-popper-ce6f60b6.js";import{a as h,E as i,b as x,c as w,d as P,e as k,f as T,g as v,h as z,i as B}from"./cms_help-67787740.js";import{E as f,a as S,b as A}from"./el-form-item-9707b8fb.js";import{_ as q,o as U,e as K,I as d,M as a,w as s,O as M,J as b,K as N}from"./index-605b105c.js";import"./aria-bc8e8b0f.js";const j=async t=>{try{return await h.request({url:"/mall/cms-help-category/one/"+t,method:"get"})}catch(e){throw e}},F=async t=>{try{return await h.request({url:"/mall/cms-help-category/del/"+t,method:"get"})}catch(e){throw e}},O=async t=>{try{return await h.request({url:"/mall/cms-help-category/edit",method:"post",data:t})}catch(e){throw e}},H=async t=>{try{return await h.request({url:"/mall/cms-help-category/add",method:"post",data:t})}catch(e){throw e}},J=async t=>{try{return await h.request({url:"/mall/cms-help-category/page",method:"post",data:t})}catch(e){throw e}},m={One:j,Del:F,Edit:O,Add:H,Page:J};const R={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null,isEdit:!1}},computed:{paginatedData(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.filteredtableData.slice(t,e)},filteredtableData(){return this.searchText&&this.tableData&&this.tableData.length>0?this.tableData.filter(t=>String(t.name).includes(String(this.searchText))):this.tableData||[]}},methods:{openEditDialog(t){this.isEdit=!0,this.editItem={...t},this.editDialogVisible=!0},handlePageChange(t){this.currentPage=t},saveEdit(){console.log(this.editItem),f.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.tableData.findIndex(e=>e.id===this.editItem.id);t!==-1?this.tableData.splice(t,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,this.Alter(this.editItem),this.editItem={}}).catch(()=>{})},fetchData(){m.Page(this.json).then(t=>{console.log(t),this.tableData=t.data.data.page.records||t.data.records,console.log(this.tableData)}).catch(t=>{console.error("Error fetching data:",t)})},Insert(t){m.Add(t).then(e=>{i.success("插入数据成功！"),console.log(e)}).catch(e=>{i.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(t){m.Edit(t).then(e=>{console.log("修改保存成功:",e.data)}).catch(e=>{console.error("保存修改失败:",e)}),this.fetchData()},Del(t){f.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{m.Del(t.id).then(e=>{const p=this.tableData.findIndex(_=>_.id===t.id);p!==-1&&this.tableData.splice(p,1),i.success("删除成功！")}).catch(e=>{i.error(response.msg)})}).catch(()=>{})},add(){this.isEdit=!1,this.editDialogVisible=!0,this.editItem={}},addAPI(){this.Insert(this.editItem);const t=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(t),this.editDialogVisible=!1,this.fetchData()},choose(){this.isEdit?this.saveEdit():this.addAPI()},getData(t){x.getCmsHelpsByCategoryId(t.id).then(e=>{i.success("查询成功！"),console.log(e)}).catch(()=>{i.error("请输入正确的categoryid")})}},created(){this.fetchData()}},G={class:"root"},L={style:{display:"flex"}},Q=d("span",null,"添加",-1),W=d("span",null,"编辑",-1),X=d("span",null,"删除",-1),Y={slot:"footer"};function Z(t,e,p,_,o,n){const r=w,u=P,c=z,D=B,y=k,I=T,g=S,V=A,C=v;return U(),K("div",G,[d("div",L,[a(r,{type:"primary",size:"normal",onClick:n.add},{default:s(()=>[Q]),_:1},8,["onClick"]),a(u,{modelValue:o.searchText,"onUpdate:modelValue":e[0]||(e[0]=l=>o.searchText=l),placeholder:"请输入搜索关键字",clearable:"",onClear:t.clearSearch,onKeyup:M(t.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"])]),a(y,{data:n.paginatedData,"header-cell-style":{background:"#feeeed",color:"#606266"},borde:""},{default:s(()=>[a(c,{prop:"id",label:"id"}),a(c,{prop:"name",label:"名称"}),a(c,{width:"300rpx",prop:"icon",label:"图标"},{default:s(({row:l})=>[a(D,{src:l.icon},null,8,["src"])]),_:1}),a(c,{prop:"helpCount",label:"帮助数量"}),a(c,{width:"300rpx",label:"操作"},{default:s(({row:l})=>[a(r,{type:"info",size:"mini",onClick:E=>n.openEditDialog(l)},{default:s(()=>[W]),_:2},1032,["onClick"]),a(r,{type:"danger",size:"mini",onClick:E=>n.Del(l)},{default:s(()=>[X]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(I,{"current-page":o.currentPage,"page-size":o.pageSize,total:n.filteredtableData.length,onCurrentChange:n.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),a(C,{class:"form",modelValue:o.editDialogVisible,"onUpdate:modelValue":e[5]||(e[5]=l=>o.editDialogVisible=l),onClose:e[6]||(e[6]=l=>o.editDialogVisible=!1)},{default:s(()=>[a(V,null,{default:s(()=>[a(g,{label:"名称"},{default:s(()=>[a(u,{modelValue:o.editItem.name,"onUpdate:modelValue":e[1]||(e[1]=l=>o.editItem.name=l)},null,8,["modelValue"])]),_:1}),a(g,{label:"图标"},{default:s(()=>[a(u,{modelValue:o.editItem.icon,"onUpdate:modelValue":e[2]||(e[2]=l=>o.editItem.icon=l)},null,8,["modelValue"])]),_:1}),a(g,{label:"帮助数量"},{default:s(()=>[a(u,{modelValue:o.editItem.helpCount,"onUpdate:modelValue":e[3]||(e[3]=l=>o.editItem.helpCount=l)},null,8,["modelValue"])]),_:1})]),_:1}),d("div",Y,[a(r,{onClick:e[4]||(e[4]=l=>o.editDialogVisible=!1)},{default:s(()=>[b("取消")]),_:1}),a(r,{type:"primary",onClick:n.choose},{default:s(()=>[b(N(o.isEdit?"更新":"添加"),1)]),_:1},8,["onClick"])])]),_:1},8,["modelValue"])])}const oe=q(R,[["render",Z]]);export{oe as default};
